<html>
<head>
	<meta http-equiv="content-type" charset="UTF-8">
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({ 
	  TeX: {  extensions: ["color.js"] }
	});
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_CHTML"></script>
	<title>連立方程式を解く</title> 
	<script language="javascript" type="text/javascript">
	function OnClick() {
		var p1 = {numerator : Number(document.getElementById("keisuu_1").value), denominator : 1};
		var p2 = {numerator : Number(document.getElementById("keisuu_2").value), denominator : 1};
		var p3 = {numerator : Number(document.getElementById("keisuu_3").value), denominator : 1};

		var p4 = {numerator : Number(document.getElementById("keisuu_4").value), denominator : 1};
		var p5 = {numerator : Number(document.getElementById("keisuu_5").value), denominator : 1};
		var p6 = {numerator : Number(document.getElementById("keisuu_6").value), denominator : 1};

		var p7 = {numerator : Number(document.getElementById("keisuu_7").value), denominator : 1};
		var p8 = {numerator : Number(document.getElementById("keisuu_8").value), denominator : 1};
		var p9 = {numerator : Number(document.getElementById("keisuu_9").value), denominator : 1};

		var a1 = {numerator : Number(document.getElementById("atai_1").value), denominator : 1};
		var a2 = {numerator : Number(document.getElementById("atai_2").value), denominator : 1};
		var a3 = {numerator : Number(document.getElementById("atai_3").value), denominator : 1};
		var target = document.getElementById("answer");

		var m = make_3_3_matrix(p1, p2, p3, p4, p5, p6, p7, p8, p9);
		var x = [a1, a2, a3];
		var det = get_3_3_determinant(m);
		var inv_m, sol;

		if (det.numerator != 0 ) {
			inv_m = get_3_3_inverse(m);

			sol = multi_3_3_matrix_vector(inv_m, x);

			target.innerHTML = "\\(l=";
			if (sol[0].numerator == 0) {
				target.innerHTML += "0";
			} else {
				target.innerHTML += my_frac_to_latex_string(sol[0],0);
			}
			target.innerHTML += ",m=";
			if (sol[1].numerator == 0) {
				target.innerHTML += "0";
			} else {
				target.innerHTML += my_frac_to_latex_string(sol[1],0);
			}
			target.innerHTML += ",n=";
			if (sol[2].numerator == 0) {
				target.innerHTML += "0";
			} else {
				target.innerHTML += my_frac_to_latex_string(sol[2],0);
			}
			target.innerHTML += "\\)";
		} else {
			target.innerHTML = "解けません";
		}

		//mathjaxによる描画を要求する
		MathJax.Hub.Queue(["Typeset",MathJax.Hub,target]);
	}

	function make_2_2_matrix (a00, a01, a10, a11) {
		var m = [[a00, a01],
			[a10, a11]];
		return m;
	}
	function make_3_3_matrix (a00, a01, a02, a10, a11, a12, a20, a21, a22) {
		var m = [[a00, a01, a02],
			 [a10, a11, a12],
			 [a20, a21, a22]];
		return m;
	}

	function get_2_2_determinant(m) {
		var z = my_diff_fraction(my_multiple_fraction(m[0][0], m[1][1]), my_multiple_fraction(m[0][1], m[1][0]));

		return z;
	}
	function get_3_3_determinant(m) {
		var z = my_add_fraction(my_multiple_fraction(my_multiple_fraction(m[0][0], m[1][1]), m[2][2]),
					my_multiple_fraction(my_multiple_fraction(m[0][1], m[1][2]), m[2][0]));
		 z = my_add_fraction(z, my_multiple_fraction(my_multiple_fraction(m[0][2], m[1][0]), m[2][1]));
		 z =my_diff_fraction(z, my_multiple_fraction(my_multiple_fraction(m[0][2], m[1][1]), m[2][0]));
		 z =my_diff_fraction(z, my_multiple_fraction(my_multiple_fraction(m[0][1], m[1][0]), m[2][2]));
		 z =my_diff_fraction(z, my_multiple_fraction(my_multiple_fraction(m[0][0], m[1][2]), m[2][1]));

		return z;
	}

	function get_2_2_inverse(m) {
		var minus = {numerator : -1,
				denominator : 1};
		var d = my_get_reciprocal(get_2_2_determinant(m));

		var n = [[my_multiple_fraction(d, m[1][1]), my_multiple_fraction(d, my_multiple_fraction(minus, m[0][1]))],
			[my_multiple_fraction(d, my_multiple_fraction(minus, m[1][0])), my_multiple_fraction(d, m[0][0])]];
		return n;
	}
	function get_3_3_inverse(m) {
		var minus = {numerator : -1,
				denominator : 1};
		var d = my_get_reciprocal(get_3_3_determinant(m));

		var n = [[my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[1][1],m[2][2]),my_multiple_fraction(m[1][2],m[2][1]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][2],m[2][1]),my_multiple_fraction(m[0][1],m[2][2]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][1],m[1][2]),my_multiple_fraction(m[0][2],m[1][1])))],
			 [my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[1][2],m[2][0]),my_multiple_fraction(m[1][0],m[2][2]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][0],m[2][2]),my_multiple_fraction(m[0][2],m[2][0]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][2],m[1][0]),my_multiple_fraction(m[0][0],m[1][2])))],
			 [my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[1][0],m[2][1]),my_multiple_fraction(m[1][1],m[2][0]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][1],m[2][0]),my_multiple_fraction(m[0][0],m[2][1]))),
			  my_multiple_fraction(d, my_diff_fraction(my_multiple_fraction(m[0][0],m[1][1]),my_multiple_fraction(m[0][1],m[1][0])))]];
		return n;
	}

	function multi_2_2_matrix_vector(m, x) {
		var y = [my_add_fraction(my_multiple_fraction(m[0][0], x[0]), my_multiple_fraction(m[0][1], x[1])),
			my_add_fraction(my_multiple_fraction(m[1][0], x[0]), my_multiple_fraction(m[1][1], x[1]))];
		return y;
	}
	function multi_3_3_matrix_vector(m, x) {
		var y = [my_add_fraction(my_add_fraction(my_multiple_fraction(m[0][0], x[0]), my_multiple_fraction(m[0][1], x[1])),my_multiple_fraction(m[0][2], x[2])),
			 my_add_fraction(my_add_fraction(my_multiple_fraction(m[1][0], x[0]), my_multiple_fraction(m[1][1], x[1])),my_multiple_fraction(m[1][2], x[2])),
			 my_add_fraction(my_add_fraction(my_multiple_fraction(m[2][0], x[0]), my_multiple_fraction(m[2][1], x[1])),my_multiple_fraction(m[2][2], x[2]))];
		return y;
	}

	//2×2の連立方程式
	// (a1)x+(b1)y = c1
	// (a2)x+(b2)y = c2  を解く
	function renritsu_2_2 (a1, b1, c1, a2, b2, c2) {
		var m = make_2_2_matrix(a1, b1, a2, b2);
		var x = [c1, c2];
		var det = get_2_2_determinant(m);
		var inv_m, sol;

		if (det.numerator != 0 ) {
			inv_m = get_2_2_inverse(m);

			sol = multi_2_2_matrix_vector(inv_m, x);
			return sol;
		}
	}
	//3×3の連立方程式
	// (a1)x+(b1)y+(c1)z = d1
	// (a2)x+(b2)y+(c2)z = d2
	// (a3)x+(b3)y+(c3)z = d3 を解く
	function renritsu_3_3 (a1, b1, c1, d1, a2, b2, c2, d2, a3, b3, c3, d3) {
		var m = make_3_3_matrix(a1, b1, c1, a2, b2, c2, a3, b3, c3);
		var x = [d1, d2, d3];
		var det = get_3_3_determinant(m);
		var inv_m, sol;

		if (det.numerator != 0 ) {
			inv_m = get_3_3_inverse(m);

			sol = multi_3_3_matrix_vector(inv_m, x);
			return sol;
		}
	}

	//分数の逆数を返す。0ならそのまま返す。
	function my_get_reciprocal(x) {

		var z = {numerator : x.numerator,
			denominator : x.denominator};

		if ( x.numerator != 0 ) {
			if (x.numerator > 0) {
				z = {numerator : x.denominator,
					denominator : x.numerator};
			} else {
				z = {numerator : x.denominator * (-1),
					denominator : x.numerator * (-1)};
			}
		}
		return z;
	}

	//分数の足し算
	function my_add_fraction(x, y) {
		const divisor = my_EuclidsAlgorithm(x.denominator, y.denominator)
		const xbaibun = y.denominator / divisor;
		const ybaibun = x.denominator / divisor;
		var z = {numerator : (x.numerator * xbaibun) + (y.numerator * ybaibun),
			denominator : (x.denominator * xbaibun)};
		return my_about(z);
	}

	//分数の引き算
	function my_diff_fraction(x, y) {
		var minus = {numerator : -1,
				denominator : 1};
		var z = my_add_fraction(x, my_multiple_fraction(minus, y));
		return z;
	}

	//分数の掛け算
	function my_multiple_fraction(x, y) {
		var z = {numerator : (x.numerator * y.numerator),
			denominator : (x.denominator * y.denominator)};
		return my_about(z);
	}

	//約分
	//分子は正の数でも負の数でもよい。分母は正の数のみ許容する。
	function my_about(x) {
		var minus = 0;

		//分子が0なら何もしない
		if (x.numerator == 0) {
			return x;
		}

		//分子が負の数なら一旦正の数にしておいて、最後に戻す
		if (x.numerator < 0) {
			x.numerator = x.numerator * (-1);
			minus = 1;
		}

		const divisor = my_EuclidsAlgorithm(x.numerator, x.denominator)

		x.numerator = x.numerator/divisor;
		x.denominator = x.denominator/divisor;

		if (minus == 1) {
			x.numerator = x.numerator * (-1);
		}
		return x;
	}

	//ユークリッドの互除法によってaとbの最大公約数を求める
	function my_EuclidsAlgorithm(a, b) {
		if (b > a) {
			//aとbを入れ替える
			const temp = a;
			a = b;
			b= temp;
		}

		const remainder = a % b;

		if (remainder == 0) {
			return b;
		} else {
			return my_EuclidsAlgorithm(b, remainder);
		}

	}

	//コンビネーション
	function my_conbnation(n,r) {
		return (my_factorial(n) / (my_factorial(r) * my_factorial(n-r)));
	}

	//階乗
	function my_factorial(n) {
		if (n==0) {
			return 1;
		}
		return (n * my_factorial(n-1));
	}

	//累乗(aのb乗)
	function my_exponential(a,b) {
		if (b==0) {
			return 1;
		}
		return (a*my_exponential(a, (b-1)));
	}

	//累乗(aのb乗。aは分数、bは整数)
	//使ってないよー
	function my_exponential_fraction(a,b) {
		var ichi = {numerator : 1,
			denominator : 1 };

		if (b == 0) {
			return ichi;
		}
		return (my_multiple_fraction(a, my_exponential_fraction(a, b-1)));
	}

	//分数をlatex表現にする。
	//第2引数は整数1、-1の場合に表示を省略するかどうか
	//omitte:0 省略しない
	//omitte:1 省略する
	function my_frac_to_latex_string(a, omitte) {
		var latex = "";

		//0はスルー
		if (a.numerator == 0) {
			return latex;
		}
		//分母が1なら整数表示
		if (a.denominator == 1) {
			if (a.numerator == 1) {
				if (omitte == 0) {
					latex += String(a.numerator);
				} else {
					//このケースは表示を省略
				}
			} else if (a.numerator == -1) {
				if (omitte == 0) {
					latex += String(a.numerator);
				} else {
					latex += "-";
				}
			} else {
				latex += String(a.numerator);
			}
			return latex;
		}
		//マイナスの記号は分数の前に出す
		if (a.numerator < 0) {
			latex += "-";
		}
		//分母が1でなければ分数表示
		latex += "\\frac{";
		if (a.numerator < 0) {
			latex += String(a.numerator * (-1));
		} else {
			latex += String(a.numerator);
		}
		latex += "}{";
		latex += String(a.denominator);
		latex += "}";
		return latex;
	}

	window.onload = function() {
	}

</script>
<style>
	table {
		table-layout: fixed;     /* 固定レイアウト */
	}
</style>
</head>
<body>
<h1>連立方程式を解く</h1>
<p>
	<input type="text" id="keisuu_1" value="" size="3" maxlength="3"/>
	\(l+ \)
	<input type="text" id="keisuu_2" value="" size="3" maxlength="3"/>
	\(m+ \)
	<input type="text" id="keisuu_3" value="" size="3" maxlength="3"/>
	\(n= \)
	<input type="text" id="atai_1" value="" size="3" maxlength="3"/>
</p>
<p>
	<input type="text" id="keisuu_4" value="" size="3" maxlength="3"/>
	\(l+ \)
	<input type="text" id="keisuu_5" value="" size="3" maxlength="3"/>
	\(m+ \)
	<input type="text" id="keisuu_6" value="" size="3" maxlength="3"/>
	\(n= \)
	<input type="text" id="atai_2" value="" size="3" maxlength="3"/>
</p>
<p>
	<input type="text" id="keisuu_7" value="" size="3" maxlength="3"/>
	\(l+ \)
	<input type="text" id="keisuu_8" value="" size="3" maxlength="3"/>
	\(m+ \)
	<input type="text" id="keisuu_9" value="" size="3" maxlength="3"/>
	\(n= \)
	<input type="text" id="atai_3" value="" size="3" maxlength="3"/>
</p>
<input type="button" value="計算" onclick="OnClick()"/>
<p id="answer">
</p>
<a href="santenen.html">3点を通る円の方程式を求める</a>
</body>
</html>